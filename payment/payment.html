<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Payment</title>
</head>
<body>
    <h2>Event Payment Form</h2>
    
    <form id="paymentForm">
        <input type="text" id="username" placeholder="Enter name" required>
        <input type="number" id="amount" placeholder="Enter amount" required>
        <button type="submit">Submit</button>
    </form>

    <h3>Payment Records:</h3>
    <ul id="paymentsList"></ul>

    <!-- Firebase SDK -->
    <script type="module">
        // Import necessary Firebase functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";

        // Your Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCqT-JZP038sERBgoRaiqRmPkVGDUGYLPw",
            authDomain: "event-payment-30106.firebaseapp.com",
            databaseURL: "https://event-payment-30106-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "event-payment-30106",
            storageBucket: "event-payment-30106.appspot.com",
            messagingSenderId: "171503241159",
            appId: "1:171503241159:web:2347c107e65fb7a4003be2"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Reference to "payments" collection in Firebase
        const paymentsRef = ref(database, "payments");

        // Submit payment data
        document.getElementById("paymentForm").addEventListener("submit", function(e) {
            e.preventDefault();

            const username = document.getElementById("username").value;
            const amount = document.getElementById("amount").value;

            // Push new data to Firebase
            push(paymentsRef, {
                username: username,
                amount: amount,
                timestamp: new Date().toISOString()
            });

            alert("Payment data submitted!");
        });

        // Retrieve and display payment data
        onValue(paymentsRef, (snapshot) => {
            const data = snapshot.val();
            const paymentsList = document.getElementById("paymentsList");
            paymentsList.innerHTML = ""; // Clear list before updating

            if (data) {
                Object.values(data).forEach(payment => {
                    const listItem = document.createElement("li");
                    listItem.textContent = `${payment.username} paid $${payment.amount} on ${payment.timestamp}`;
                    paymentsList.appendChild(listItem);
                });
            }
        });
    </script>
</body>
</html>
